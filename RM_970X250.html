<html>
<head>
	<script type="text/javascript">
		var clickTag = "{{LANDING_PAGE_URL}}";
	</script>
	<script type="text/javascript" src="https://s.adx.io/html5/v1/dxstream.min.js"></script>
</head>
<div id="canvas">
	<a id="clickId" href="javascript:window.open(clickTag,'_blank')">
		<img id="background" src="{{BACKGROUND_IMAGE}}"></img>
	</a>
	<div id="overlay">
		<img id="foreground" src="{{FOREGROUND_IMAGE}}"></img>
		<div id="handle" draggable="true">
			<div id="handlebar" class="animate"></div>
		</div>
	</div>
</div>
<div id="slideUp" class="row center slideUp">
  <div id="arrowContainer" class="col-md-2 animate square row">
    <div id="arrows" class="unselectable">
      <span class="arrow">&#9650;</span> <br id="brTag">
      <span class="arrow">&#9660;</span>
    </div>
  </div>
</div>
<style>
	* {
		margin: 0;
		padding: 0;
        box-sizing: border-box;
	}

  .arrow{
    color: white;
  }
  .square {
    padding: 5px 15px;
    background-color: black;
    position: absolute;
  }
  .line {
    flex-basis: 100%
  }
  
  #arrowContainer {
    cursor: default;
    border-radius: 5px;
  }

	.slideUp {
		background-color: transparent;
		font-family: fantasy;
		font-stretch: ultra-expanded;
	}

	#canvas {
		width: 970px;
		height: 250px;
		max-height: 250px;
		position: relative;
	}

	#handlebar {
		width: 970px;
		background-color: black;
	}

	#handle {
		width: 970px;
		height: 0px;
	}

	#foreground {
		width: 970px;
	}

	#background {
		width: 970px;
		height: 250px
	}

	body {
		width: 970px;
		height: 250px;
		margin: 0px;
	}

	.center {
		text-align: center;
    display: flex;
    justify-content: center;
	}

	#overlay {
		width: 970px;
		position: fixed;
		overflow: hidden;
		top: 0;
		left: 0;
		right: 0;
		bottom: 0;
		z-index: 2;
	}

  .unselectable {
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -khtml-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
  }

	.animate {
  	animation-iteration-count: infinite;
  	animation-duration: 1.5s;
  	animation: animate 3.6s ease infinite;
  	transform-origin: 50% 50%;
	}

	@keyframes animate {
		0% {
			transform: translateY(0);
		}
		5.55556% {
			transform: translateY(0);
		}
		11.11111% {
			transform: translateY(0);
		}
		22.22222% {
			transform: translateY(-15px);
		}
		27.77778% {
			transform: translateY(0);
		}
		33.33333% {
			transform: translateY(-15px);
		}
		44.44444% {
			transform: translateY(0);
		}
		100% {
			transform: translateY(0);
		}
	}	

</style>
<script>
	let currentDroppable = null;
	var adwidth = 970;
	var adheight = 250;
	var arrowFontSize = 0;
  var arrowSubPix = Math.min(Math.ceil((5 * adheight) / 250), 5);
  if (arrowSubPix == 1) {
    arrowSubPix = 0;
    arrowContainer.style.padding = "1px 12px";
  }
  else if (arrowSubPix > 1 && arrowSubPix < 2)
    arrowContainer.style.padding = "3px 20px";
  if (adwidth <= 150)
    arrowContainer.style.padding = "2px 10px";
  else if (adwidth >= 600)
    arrowContainer.style.padding = "5px 25px";
  if (adheight <= 40) {
    arrowSubPix = adheight >35 ? 0 : 1;
    arrowContainer.style.padding = "1px 5px";
    brTag.style.display = "none";
  }
  // arrowSubPix = arrowSubPix < 1 ? 5 : arrowSubPix; 
	document.getElementById("overlay").style.height = 0.9 * adheight + 'px';
	document.getElementById("handlebar").style.height = 0.1 * adheight < 10 ? 0.1 * adheight + 'px' : 8 + 'px';
  
	document.getElementById("handle").style.height = 0.2 * adheight + 'px';
	document.getElementById("foreground").style.height = 0.8 * adheight + 'px';
  
	document.getElementById("slideUp").style.fontSize = 0.08 * adheight + 'px';
  
  arrowFontSize = Math.min(0.05 * adheight, 12.5);
  arrowFontSize = arrowFontSize < 5 ? arrowFontSize < 2 ? 3 :  5 : arrowFontSize;
  arrowContainer.style.top = (0.8 * adheight) - (arrowFontSize + arrowSubPix) + 'px'
  arrows.style.fontSize = arrowFontSize < 5 ? arrowFontSize < 2 ? 3 :  5 : arrowFontSize;
  clickId.style.pointerEvents = "none";
	var mouseisOut = false;
	var isMouseDown = false;
  handle.style.zIndex = 100;
  arrowContainer.style.zIndex = 110;
	handle.style.position = 'absolute';
	handle.style.height = 0;

	function getPx(ele) {
			return parseInt(ele.substring(0,ele.length - 2));
	}

  arrowContainer.onmousedown = (event) => {
    onMouseDownHandler(event);
	};

	handle.onmousedown = (event) => {
		onMouseDownHandler(event);
	}
	
	function onMouseDownHandler (event) {
		isMouseDown = true;		
		handlebar.classList.remove("animate");
		arrowContainer.classList.remove("animate");
		let shiftY = event.clientY - handle.getBoundingClientRect().top;
		let arrowShiftY = handle.getBoundingClientRect().top;
    document.body.append(handle);
		if (!mouseisOut && isMouseDown) {
			moveAt(event.pageX, event.pageY);
		}


		function moveAt(pageX, pageY) {
			// for slide effect
      if (pageY < adheight) {
        clickId.style.pointerEvents = "auto";
        handle.style.top = pageY - shiftY + 'px';
        arrowContainer.style.top = (pageY - shiftY) - arrowFontSize - arrowSubPix + 'px';
				overlay.style.height = pageY - shiftY + 'px';
			}

			// to handle slider not go outside the limit
			if (pageY >= 0.75 * adheight ) {
				handle.style.top = `${0.8 * adheight}px`;
        arrowContainer.style.top = `${(0.8 * adheight) - arrowFontSize - arrowSubPix}px`;
				overlay.style.height = `${0.8 * adheight}px`;
			} else if (pageY < 0.15 * adheight) {
        handle.style.top = `${0.1 * adheight}px`;
        arrowContainer.style.top = `${(0.1 * adheight) - arrowFontSize - arrowSubPix}px`;
				overlay.style.height = `${0.1 * adheight}px`;				
			}

		}

		function onMouseMove(event) {
			if (isMouseDown) moveAt(event.pageX, event.pageY);
		}

		document.addEventListener('mousemove', onMouseMove);
    
    document.onmouseup = () => {onMouseUpHandler();}

		function onMouseUpHandler () {
			isMouseDown = false;
			document.removeEventListener('mousemove', onMouseMove);
			arrowContainer.onmouseup = null;
			handle.onmouseup = null;
		} 
	};

	handle.ondragstart = function () {
		return false;
  };

</script>

</html>
